[gd_scene load_steps=67 format=3 uid="uid://oyjh005vyqcv"]

[ext_resource type="Script" path="res://Scripts/UI/Sayori_penetrating.cs" id="1_k0rxl"]
[ext_resource type="Texture2D" uid="uid://bs7c7ht1qr80w" path="res://Assets/Textures/Character/s_sticker_1.png" id="2_giu3u"]
[ext_resource type="Script" path="res://Scripts/characters/Movements.cs" id="3_bibx4"]
[ext_resource type="Script" path="res://ai/tasks/direction_left.cs" id="4_7bsnm"]
[ext_resource type="Script" path="res://ai/tasks/direction_change.cs" id="5_po8g6"]
[ext_resource type="Texture2D" uid="uid://dqvgghwh2cn35" path="res://Assets/Textures/Character/s_sticker_2.png" id="6_g6ny1"]
[ext_resource type="Script" path="res://Scripts/characters/MouseMove.cs" id="7_tfj0f"]

[sub_resource type="BlackboardPlan" id="BlackboardPlan_da1h4"]

[sub_resource type="BTAction" id="BTAction_t6exr"]
script = ExtResource("4_7bsnm")

[sub_resource type="BBNode" id="BBNode_8w710"]
resource_name = "AnimationPlayer"
saved_value = NodePath("AnimationPlayer")

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_o7myb"]
animation_player = SubResource("BBNode_8w710")
animation_name = &"right"

[sub_resource type="BTProbability" id="BTProbability_70glq"]
children = [SubResource("BTPlayAnimation_o7myb")]
run_chance = 0.3

[sub_resource type="BTAction" id="BTAction_la6em"]
script = ExtResource("5_po8g6")

[sub_resource type="BTWait" id="BTWait_ycd4v"]

[sub_resource type="BTAction" id="BTAction_oql6k"]
script = ExtResource("4_7bsnm")

[sub_resource type="BTWait" id="BTWait_7gwxo"]
duration = 0.5

[sub_resource type="BBNode" id="BBNode_h4cof"]
resource_name = "movements"
saved_value = NodePath("movements")

[sub_resource type="BTCallMethod" id="BTCallMethod_rwx0h"]
node = SubResource("BBNode_h4cof")
method = &"jump_right"

[sub_resource type="BTFail" id="BTFail_8pox1"]

[sub_resource type="BTComment" id="BTComment_12bav"]
custom_name = "如果方向为左，百分之三十变右.1秒后向右跳动"

[sub_resource type="BTSequence" id="BTSequence_j5w2t"]
custom_name = "direction_change"
children = [SubResource("BTAction_t6exr"), SubResource("BTProbability_70glq"), SubResource("BTAction_la6em"), SubResource("BTWait_ycd4v"), SubResource("BTAction_oql6k"), SubResource("BTWait_7gwxo"), SubResource("BTCallMethod_rwx0h"), SubResource("BTFail_8pox1"), SubResource("BTComment_12bav")]

[sub_resource type="BTAction" id="BTAction_3q5wi"]
script = ExtResource("4_7bsnm")

[sub_resource type="BTInvert" id="BTInvert_w2lod"]
children = [SubResource("BTAction_3q5wi")]

[sub_resource type="BBNode" id="BBNode_vlvd3"]
resource_name = "AnimationPlayer"
saved_value = NodePath("AnimationPlayer")

[sub_resource type="BTPlayAnimation" id="BTPlayAnimation_677jj"]
animation_player = SubResource("BBNode_vlvd3")
animation_name = &"left"

[sub_resource type="BTProbability" id="BTProbability_ldvvw"]
children = [SubResource("BTPlayAnimation_677jj")]
run_chance = 0.3

[sub_resource type="BTAction" id="BTAction_0tt47"]
script = ExtResource("5_po8g6")

[sub_resource type="BTWait" id="BTWait_ir8au"]

[sub_resource type="BTAction" id="BTAction_huigm"]
script = ExtResource("4_7bsnm")

[sub_resource type="BTInvert" id="BTInvert_jt1jx"]
children = [SubResource("BTAction_huigm")]

[sub_resource type="BBNode" id="BBNode_keyda"]
resource_name = "movements"
saved_value = NodePath("movements")

[sub_resource type="BTCallMethod" id="BTCallMethod_a2euh"]
node = SubResource("BBNode_keyda")
method = &"jump_left"

[sub_resource type="BTFail" id="BTFail_nowof"]

[sub_resource type="BTComment" id="BTComment_tbyi7"]
custom_name = "如果方向为右，百分之三十变左.1秒后向左跳动"

[sub_resource type="BTSequence" id="BTSequence_7vv2i"]
custom_name = "direction_change"
children = [SubResource("BTInvert_w2lod"), SubResource("BTProbability_ldvvw"), SubResource("BTAction_0tt47"), SubResource("BTWait_ir8au"), SubResource("BTInvert_jt1jx"), SubResource("BTCallMethod_a2euh"), SubResource("BTFail_nowof"), SubResource("BTComment_tbyi7")]

[sub_resource type="BTWait" id="BTWait_7flae"]

[sub_resource type="BTProbability" id="BTProbability_jxogi"]
children = [SubResource("BTWait_7flae")]
run_chance = 0.3

[sub_resource type="BTAlwaysSucceed" id="BTAlwaysSucceed_sh7l6"]
children = [SubResource("BTProbability_jxogi")]

[sub_resource type="BTFail" id="BTFail_ygg58"]

[sub_resource type="BTComment" id="BTComment_r0x1l"]
custom_name = "概率等待"

[sub_resource type="BTSequence" id="BTSequence_l80hl"]
custom_name = "Standby"
children = [SubResource("BTAlwaysSucceed_sh7l6"), SubResource("BTFail_ygg58"), SubResource("BTComment_r0x1l")]

[sub_resource type="BTAction" id="BTAction_stvxd"]
script = ExtResource("4_7bsnm")

[sub_resource type="BBNode" id="BBNode_2wttv"]
resource_name = "movements"
saved_value = NodePath("movements")

[sub_resource type="BTCallMethod" id="BTCallMethod_naaxl"]
node = SubResource("BBNode_2wttv")
method = &"jump_left"

[sub_resource type="BTProbability" id="BTProbability_1rsm3"]
children = [SubResource("BTCallMethod_naaxl")]
run_chance = 0.7

[sub_resource type="BTFail" id="BTFail_xyw6n"]

[sub_resource type="BTComment" id="BTComment_q70ty"]
custom_name = "如果方向为左，百分之五十向左跳跃"

[sub_resource type="BTSequence" id="BTSequence_kjnas"]
custom_name = "jump_left"
children = [SubResource("BTAction_stvxd"), SubResource("BTProbability_1rsm3"), SubResource("BTFail_xyw6n"), SubResource("BTComment_q70ty")]

[sub_resource type="BTAction" id="BTAction_yn5yy"]
script = ExtResource("4_7bsnm")

[sub_resource type="BTInvert" id="BTInvert_f8u2l"]
children = [SubResource("BTAction_yn5yy")]

[sub_resource type="BBNode" id="BBNode_bf8yg"]
resource_name = "movements"
saved_value = NodePath("movements")

[sub_resource type="BTCallMethod" id="BTCallMethod_ldw1x"]
node = SubResource("BBNode_bf8yg")
method = &"jump_right"

[sub_resource type="BTProbability" id="BTProbability_ghim3"]
children = [SubResource("BTCallMethod_ldw1x")]

[sub_resource type="BTFail" id="BTFail_v20cf"]

[sub_resource type="BTComment" id="BTComment_phctw"]
custom_name = "如果方向为右，百分之五十向右跳跃"

[sub_resource type="BTSequence" id="BTSequence_l48ts"]
custom_name = "jump_right"
children = [SubResource("BTInvert_f8u2l"), SubResource("BTProbability_ghim3"), SubResource("BTFail_v20cf"), SubResource("BTComment_phctw")]

[sub_resource type="BTWait" id="BTWait_knjk4"]

[sub_resource type="BTSelector" id="BTSelector_q2qru"]
children = [SubResource("BTSequence_j5w2t"), SubResource("BTSequence_7vv2i"), SubResource("BTSequence_l80hl"), SubResource("BTSequence_kjnas"), SubResource("BTSequence_l48ts"), SubResource("BTWait_knjk4")]

[sub_resource type="BehaviorTree" id="BehaviorTree_j7gof"]
blackboard_plan = SubResource("BlackboardPlan_da1h4")
root_task = SubResource("BTSelector_q2qru")

[sub_resource type="BlackboardPlan" id="BlackboardPlan_wid3d"]

[sub_resource type="Animation" id="Animation_4ti7m"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("TextureRect:scale")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(1, 1)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("TextureRect:rotation")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("TextureRect:texture")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [ExtResource("2_giu3u")]
}
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("Polygon2D:polygon")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [PackedVector2Array(505, 358, 548, 279, 615, 293, 648, 358, 594, 464, 557, 469)]
}
tracks/4/type = "value"
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/path = NodePath("movements:character_direction")
tracks/4/interp = 1
tracks/4/loop_wrap = true
tracks/4/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}

[sub_resource type="Animation" id="Animation_5741r"]
resource_name = "grab"
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("TextureRect:rotation")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.233333, 0.5, 0.733333, 1),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1),
"update": 0,
"values": [0.0, 0.174533, 0.0, -0.174533, 0.0]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("TextureRect:texture")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [ExtResource("6_g6ny1")]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Polygon2D:polygon")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [PackedVector2Array(405, 284, 548, 279, 725, 279, 730, 471, 589, 475, 387, 486)]
}
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("TextureRect:scale")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector2(1, 1)]
}
tracks/4/type = "value"
tracks/4/imported = false
tracks/4/enabled = true
tracks/4/path = NodePath("movements:character_direction")
tracks/4/interp = 1
tracks/4/loop_wrap = true
tracks/4/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}

[sub_resource type="Animation" id="Animation_2u3uh"]
resource_name = "left"
length = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("TextureRect:scale")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(-1, 1), Vector2(1, 1)]
}

[sub_resource type="Animation" id="Animation_c1hee"]
resource_name = "recovery"
length = 0.1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("TextureRect:texture")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [ExtResource("2_giu3u")]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("TextureRect:rotation")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [0.0]
}
tracks/2/type = "value"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("Polygon2D:polygon")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [PackedVector2Array(505, 358, 548, 279, 615, 293, 648, 358, 594, 464, 557, 469)]
}

[sub_resource type="Animation" id="Animation_gqt0v"]
resource_name = "right"
length = 0.5
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("TextureRect:scale")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.5),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector2(1, 1), Vector2(-1, 1)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_rboqg"]
_data = {
"RESET": SubResource("Animation_4ti7m"),
"grab": SubResource("Animation_5741r"),
"left": SubResource("Animation_2u3uh"),
"recovery": SubResource("Animation_c1hee"),
"right": SubResource("Animation_gqt0v")
}

[node name="Sayori" type="Control"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
script = ExtResource("1_k0rxl")

[node name="TextureRect" type="TextureRect" parent="."]
layout_mode = 1
anchors_preset = 8
anchor_left = 0.5
anchor_top = 0.5
anchor_right = 0.5
anchor_bottom = 0.5
offset_left = -61.0
offset_top = -32.0
offset_right = 61.0
offset_bottom = 141.0
grow_horizontal = 2
grow_vertical = 2
pivot_offset = Vector2(61, 23.32)
focus_mode = 1
texture = ExtResource("2_giu3u")

[node name="movements" type="Control" parent="."]
anchors_preset = 0
offset_right = 40.0
offset_bottom = 40.0
script = ExtResource("3_bibx4")

[node name="Polygon2D" type="Polygon2D" parent="."]
color = Color(1, 1, 1, 0)
polygon = PackedVector2Array(505, 358, 548, 279, 615, 293, 648, 358, 594, 464, 557, 469)

[node name="Character_jump" type="BTPlayer" parent="."]
behavior_tree = SubResource("BehaviorTree_j7gof")
blackboard_plan = SubResource("BlackboardPlan_wid3d")

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
"": SubResource("AnimationLibrary_rboqg")
}

[node name="mouse_move" type="Node2D" parent="."]
script = ExtResource("7_tfj0f")

[connection signal="focus_entered" from="TextureRect" to="mouse_move" method="_on_texture_rect_focus_entered"]
[connection signal="focus_exited" from="TextureRect" to="mouse_move" method="_on_texture_rect_focus_exited"]
